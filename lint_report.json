[{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\check_schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\parse_lint.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\AutoLogout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ContextSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\GoalCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\Loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\MonthSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewCategoryModal.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'resetForm'. Either include it or remove the dependency array.","line":41,"column":8,"nodeType":"ArrayExpression","endLine":41,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, resetForm]","fix":{"range":[1478,1486],"text":"[isOpen, resetForm]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewGoalModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":172,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5588,5591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5588,5591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport { useProject } from \"@/contexts/ProjectContext\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\"\r\nimport { Checkbox } from \"@/components/ui/checkbox\"\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\"\r\nimport { AlertCircle, Loader2 } from \"lucide-react\"\r\nimport { NewCategoryModal } from \"./NewCategoryModal\"\r\n\r\ninterface Category {\r\n    id: string\r\n    nome: string\r\n    is_investment?: boolean\r\n    goal_id?: string | null\r\n}\r\n\r\ninterface Goal {\r\n    id: string\r\n    title: string\r\n    target_amount: number\r\n    deadline: string\r\n    categories: Category[]\r\n}\r\n\r\ninterface NewGoalModalProps {\r\n    isOpen: boolean\r\n    onClose: () => void\r\n    onSuccess: () => void\r\n    goalToEdit?: Goal | null\r\n}\r\n\r\nexport function NewGoalModal({ isOpen, onClose, onSuccess, goalToEdit }: NewGoalModalProps) {\r\n    const { user } = useAuth()\r\n    const { selectedProject } = useProject()\r\n    const [loading, setLoading] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n    const [categories, setCategories] = useState<Category[]>([])\r\n\r\n    const [title, setTitle] = useState(\"\")\r\n    const [targetAmount, setTargetAmount] = useState(\"\")\r\n    const [deadline, setDeadline] = useState(\"\")\r\n    const [selectedCategoryIds, setSelectedCategoryIds] = useState<string[]>([])\r\n\r\n    const [isCategoryModalOpen, setIsCategoryModalOpen] = useState(false)\r\n\r\n    const fetchInvestmentCategories = useCallback(async () => {\r\n        if (!user) return\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"categories\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", user.id)\r\n                .eq(\"is_investment\", true)\r\n                .order(\"nome\")\r\n\r\n            if (error) throw error\r\n            if (data) setCategories(data)\r\n        } catch (error) {\r\n            console.error(\"Error fetching categories:\", error)\r\n        }\r\n    }, [user])\r\n\r\n    const resetForm = useCallback(() => {\r\n        setTitle(\"\")\r\n        setTargetAmount(\"\")\r\n        setDeadline(\"\")\r\n        setSelectedCategoryIds([])\r\n        setError(null)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            fetchInvestmentCategories()\r\n            if (goalToEdit) {\r\n                setTitle(goalToEdit.title)\r\n                setTargetAmount(goalToEdit.target_amount.toString())\r\n                setDeadline(goalToEdit.deadline)\r\n\r\n                const initialCategories = (goalToEdit && Array.isArray(goalToEdit.categories))\r\n                    ? goalToEdit.categories\r\n                    : []\r\n                setSelectedCategoryIds(initialCategories.map(c => c.id))\r\n            } else {\r\n                resetForm()\r\n            }\r\n        }\r\n    }, [isOpen, goalToEdit, fetchInvestmentCategories, resetForm])\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        if (!user) return\r\n\r\n        setLoading(true)\r\n        setError(null)\r\n\r\n        try {\r\n            const targetAmountFloat = parseFloat(targetAmount)\r\n            if (isNaN(targetAmountFloat) || targetAmountFloat <= 0) {\r\n                throw new Error(\"Valor da meta inválido.\")\r\n            }\r\n\r\n            const goalData = {\r\n                user_id: user.id,\r\n                title,\r\n                target_amount: targetAmountFloat,\r\n                deadline,\r\n                project_id: selectedProject?.id || null\r\n            }\r\n\r\n            let goalId = goalToEdit?.id\r\n\r\n            if (goalToEdit) {\r\n                const { error: updateError } = await supabase\r\n                    .from(\"goals\")\r\n                    .update(goalData)\r\n                    .eq(\"id\", goalToEdit.id)\r\n\r\n                if (updateError) throw updateError\r\n            } else {\r\n                const { data: newGoal, error: insertError } = await supabase\r\n                    .from(\"goals\")\r\n                    .insert(goalData)\r\n                    .select()\r\n                    .single()\r\n\r\n                if (insertError) throw insertError\r\n                goalId = newGoal.id\r\n            }\r\n\r\n            if (goalId) {\r\n                if (goalToEdit) {\r\n                    const { error: clearError } = await supabase\r\n                        .from(\"categories\")\r\n                        .update({ goal_id: null })\r\n                        .eq(\"goal_id\", goalId)\r\n                    if (clearError) throw clearError\r\n                }\r\n\r\n                if (selectedCategoryIds.length > 0) {\r\n                    const { error: linkError } = await supabase\r\n                        .from(\"categories\")\r\n                        .update({ goal_id: goalId })\r\n                        .in(\"id\", selectedCategoryIds)\r\n                    if (linkError) throw linkError\r\n                }\r\n            }\r\n\r\n            onSuccess()\r\n            onClose()\r\n        } catch (err: unknown) {\r\n            if (err instanceof Error) {\r\n                setError(err.message)\r\n            } else {\r\n                setError(\"Erro ao salvar meta.\")\r\n            }\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const handleCategorySuccess = (newCategory: any) => {\r\n        fetchInvestmentCategories()\r\n        setSelectedCategoryIds(prev => [...prev, newCategory.id])\r\n    }\r\n\r\n    const toggleCategory = (categoryId: string) => {\r\n        setSelectedCategoryIds(prev =>\r\n            prev.includes(categoryId)\r\n                ? prev.filter(id => id !== categoryId)\r\n                : [...prev, categoryId]\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\r\n                <DialogContent className=\"sm:max-w-[425px]\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>{goalToEdit ? \"Editar Meta\" : \"Nova Meta\"}</DialogTitle>\r\n                        <DialogDescription>\r\n                            Defina seus objetivos financeiros e acompanhe seu progresso.\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"grid gap-4 py-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"title\">Título da Meta</Label>\r\n                            <Input\r\n                                id=\"title\"\r\n                                value={title}\r\n                                onChange={(e) => setTitle(e.target.value)}\r\n                                placeholder=\"Ex: Viagem para Europa\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"targetAmount\">Valor Alvo</Label>\r\n                            <Input\r\n                                id=\"targetAmount\"\r\n                                type=\"number\"\r\n                                step=\"0.01\"\r\n                                value={targetAmount}\r\n                                onChange={(e) => setTargetAmount(e.target.value)}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"deadline\">Data Limite</Label>\r\n                            <Input\r\n                                id=\"deadline\"\r\n                                type=\"date\"\r\n                                value={deadline}\r\n                                onChange={(e) => setDeadline(e.target.value)}\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid gap-2\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <Label>Categorias de Investimento Vinculadas</Label>\r\n                                <Button\r\n                                    type=\"button\"\r\n                                    variant=\"ghost\"\r\n                                    size=\"sm\"\r\n                                    className=\"h-8 text-xs\"\r\n                                    onClick={() => setIsCategoryModalOpen(true)}\r\n                                >\r\n                                    + Nova Categoria\r\n                                </Button>\r\n                            </div>\r\n                            <div className=\"border rounded-md p-4 max-h-[150px] overflow-y-auto space-y-2\">\r\n                                {categories.length === 0 ? (\r\n                                    <p className=\"text-sm text-muted-foreground text-center py-2\">\r\n                                        Nenhuma categoria de investimento encontrada.\r\n                                    </p>\r\n                                ) : (\r\n                                    categories.map((category) => (\r\n                                        <div key={category.id} className=\"flex items-center space-x-2\">\r\n                                            <Checkbox\r\n                                                id={`cat-${category.id}`}\r\n                                                checked={selectedCategoryIds.includes(category.id)}\r\n                                                onCheckedChange={() => toggleCategory(category.id)}\r\n                                            />\r\n                                            <Label\r\n                                                htmlFor={`cat-${category.id}`}\r\n                                                className=\"text-sm font-normal cursor-pointer\"\r\n                                            >\r\n                                                {category.nome}\r\n                                            </Label>\r\n                                        </div>\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                Selecione as categorias que contribuirão para esta meta.\r\n                            </p>\r\n                        </div>\r\n\r\n                        {error && (\r\n                            <Alert variant=\"destructive\">\r\n                                <AlertCircle className=\"h-4 w-4\" />\r\n                                <AlertTitle>Erro</AlertTitle>\r\n                                <AlertDescription>{error}</AlertDescription>\r\n                            </Alert>\r\n                        )}\r\n\r\n                        <DialogFooter>\r\n                            <Button type=\"submit\" disabled={loading}>\r\n                                {loading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : (goalToEdit ? \"Salvar Alterações\" : \"Criar Meta\")}\r\n                            </Button>\r\n                        </DialogFooter>\r\n                    </form>\r\n                </DialogContent>\r\n            </Dialog>\r\n\r\n            <NewCategoryModal\r\n                isOpen={isCategoryModalOpen}\r\n                onClose={() => setIsCategoryModalOpen(false)}\r\n                onSuccess={handleCategorySuccess}\r\n                defaultIsInvestment={true}\r\n            />\r\n        </>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewProjectModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewRecurrenceModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewTransactionModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\NewTransferModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ShadcnDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\UpgradeModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\dashboard\\AddWidgetDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Plus' is defined but never used.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Crown' is defined but never used.","line":8,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Loader2' is defined but never used.","line":8,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":30}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '../ui/dialog';\r\nimport { Button } from '../ui/button';\r\nimport { Input } from '../ui/input';\r\nimport { Label } from '../ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../ui/select';\r\nimport { ChartType, DashboardWidget } from '../../types/dashboard';\r\nimport { Plus, Crown, Loader2 } from \"lucide-react\";\r\n\r\ninterface AddWidgetDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    onAdd: (widget: Partial<DashboardWidget>) => void;\r\n}\r\n\r\nexport const AddWidgetDialog: React.FC<AddWidgetDialogProps> = ({ open, onOpenChange, onAdd }) => {\r\n    const [title, setTitle] = useState('');\r\n    const [chartType, setChartType] = useState<ChartType>('pie');\r\n    const [category, setCategory] = useState('all');\r\n\r\n    const handleSubmit = () => {\r\n        const newWidget: Partial<DashboardWidget> = {\r\n            title,\r\n            chart_type: chartType,\r\n            data_config: {\r\n                category: category !== 'all' ? category : undefined,\r\n            },\r\n            layout_config: {\r\n                i: 'temp', // Will be overwritten\r\n                x: 0,\r\n                y: Infinity,\r\n                w: chartType === 'metric' ? 2 : 6,\r\n                h: chartType === 'metric' ? 2 : 8,\r\n                minW: 2,\r\n                minH: 2,\r\n            }\r\n        };\r\n        onAdd(newWidget);\r\n        onOpenChange(false);\r\n        // Reset form\r\n        setTitle('');\r\n        setChartType('pie');\r\n        setCategory('all');\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Adicionar Novo Widget</DialogTitle>\r\n                </DialogHeader>\r\n                <div className=\"grid gap-4 py-4\">\r\n                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                        <Label htmlFor=\"title\" className=\"text-right\">\r\n                            Título\r\n                        </Label>\r\n                        <Input\r\n                            id=\"title\"\r\n                            value={title}\r\n                            onChange={(e) => setTitle(e.target.value)}\r\n                            className=\"col-span-3\"\r\n                            placeholder=\"Ex: Meus Gastos\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                        <Label htmlFor=\"type\" className=\"text-right\">\r\n                            Tipo\r\n                        </Label>\r\n                        <Select value={chartType} onValueChange={(v) => setChartType(v as ChartType)}>\r\n                            <SelectTrigger className=\"col-span-3\">\r\n                                <SelectValue placeholder=\"Selecione o tipo\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                                <SelectItem value=\"pie\">Gráfico de Pizza</SelectItem>\r\n                                <SelectItem value=\"bar\">Gráfico de Barras</SelectItem>\r\n                                <SelectItem value=\"line\">Gráfico de Linha</SelectItem>\r\n                                <SelectItem value=\"metric\">Métrica</SelectItem>\r\n                            </SelectContent>\r\n                        </Select>\r\n                    </div>\r\n\r\n                    {(chartType === 'pie' || chartType === 'bar') && (\r\n                        <div className=\"grid grid-cols-4 items-center gap-4\">\r\n                            <Label htmlFor=\"category\" className=\"text-right\">\r\n                                Dados\r\n                            </Label>\r\n                            <Select value={category} onValueChange={setCategory}>\r\n                                <SelectTrigger className=\"col-span-3\">\r\n                                    <SelectValue placeholder=\"Selecione os dados\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"all\">Todas as Categorias</SelectItem>\r\n                                    <SelectItem value=\"fixed\">Despesas Fixas</SelectItem>\r\n                                    <SelectItem value=\"variable\">Despesas Variáveis</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <DialogFooter>\r\n                    <Button type=\"submit\" onClick={handleSubmit} disabled={!title}>\r\n                        Criar Widget\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\dashboard\\DashboardGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\dashboard\\PremiumFeatureLock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\dashboard\\WidgetCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\mode-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\theme-provider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":66,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":66,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState } from \"react\"\r\n\r\ntype Theme = \"dark\" | \"light\" | \"system\"\r\n\r\ntype ThemeProviderProps = {\r\n    children: React.ReactNode\r\n    defaultTheme?: Theme\r\n    storageKey?: string\r\n}\r\n\r\ntype ThemeProviderState = {\r\n    theme: Theme\r\n    setTheme: (theme: Theme) => void\r\n}\r\n\r\nconst initialState: ThemeProviderState = {\r\n    theme: \"system\",\r\n    setTheme: () => null,\r\n}\r\n\r\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState)\r\n\r\nexport function ThemeProvider({\r\n    children,\r\n    defaultTheme = \"system\",\r\n    storageKey = \"vite-ui-theme\",\r\n    ...props\r\n}: ThemeProviderProps) {\r\n    const [theme, setTheme] = useState<Theme>(\r\n        () => (localStorage.getItem(storageKey) as Theme) || defaultTheme\r\n    )\r\n\r\n    useEffect(() => {\r\n        const root = window.document.documentElement\r\n\r\n        root.classList.remove(\"light\", \"dark\")\r\n\r\n        if (theme === \"system\") {\r\n            const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\r\n                .matches\r\n                ? \"dark\"\r\n                : \"light\"\r\n\r\n            root.classList.add(systemTheme)\r\n            return\r\n        }\r\n\r\n        root.classList.add(theme)\r\n    }, [theme])\r\n\r\n    const value = {\r\n        theme,\r\n        setTheme: (theme: Theme) => {\r\n            localStorage.setItem(storageKey, theme)\r\n            setTheme(theme)\r\n        },\r\n    }\r\n\r\n    return (\r\n        <ThemeProviderContext.Provider {...props} value={value}>\r\n            {children}\r\n        </ThemeProviderContext.Provider>\r\n    )\r\n}\r\n\r\nexport const useTheme = () => {\r\n    const context = useContext(ThemeProviderContext)\r\n\r\n    if (context === undefined)\r\n        throw new Error(\"useTheme must be used within a ThemeProvider\")\r\n\r\n    return context\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":36,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":36,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80\",\r\n        outline: \"text-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface BadgeProps\r\n  extends React.HTMLAttributes<HTMLDivElement>,\r\n    VariantProps<typeof badgeVariants> {}\r\n\r\nfunction Badge({ className, variant, ...props }: BadgeProps) {\r\n  return (\r\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":57,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":57,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\r\n        outline:\r\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2\",\r\n        sm: \"h-8 rounded-md px-3 text-xs\",\r\n        lg: \"h-10 rounded-md px-8\",\r\n        icon: \"h-9 w-9\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n  asChild?: boolean\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n    const Comp = asChild ? Slot : \"button\"\r\n    return (\r\n      <Comp\r\n        className={cn(buttonVariants({ variant, size, className }))}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\contexts\\AuthContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":180,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":180,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState, useMemo, useRef, useCallback } from \"react\"\r\nimport { Session, User } from \"@supabase/supabase-js\"\r\nimport { supabase } from \"@/lib/supabase\"\r\n\r\nimport { Profile } from \"@/types\"\r\n\r\ninterface AuthContextType {\r\n    session: Session | null\r\n    user: User | null\r\n    profile: Profile | null\r\n    loading: boolean\r\n    isDeletionScheduled: boolean\r\n    deletionDate: string | null\r\n    signOut: () => Promise<void>\r\n    refreshProfile: () => Promise<void>\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType>({\r\n    session: null,\r\n    user: null,\r\n    profile: null,\r\n    loading: true,\r\n    isDeletionScheduled: false,\r\n    deletionDate: null,\r\n    signOut: async () => { },\r\n    refreshProfile: async () => { },\r\n})\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n    const [session, setSession] = useState<Session | null>(null)\r\n    const [user, setUser] = useState<User | null>(null)\r\n    const [profile, setProfile] = useState<Profile | null>(null)\r\n    const [loading, setLoading] = useState(true)\r\n    const [isDeletionScheduled, setIsDeletionScheduled] = useState(false)\r\n    const [deletionDate, setDeletionDate] = useState<string | null>(null)\r\n\r\n    // Ref to track user for onAuthStateChange listener (avoids stale closure)\r\n    const userRef = useRef<User | null>(null)\r\n\r\n    useEffect(() => {\r\n        userRef.current = user\r\n    }, [user])\r\n\r\n    const fetchProfileData = useCallback(async (userId: string) => {\r\n        try {\r\n            const { data: profileData, error } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", userId)\r\n                .single()\r\n\r\n            if (error) {\r\n                console.error(\"Error fetching profile:\", error)\r\n                return null\r\n            }\r\n\r\n            return profileData as Profile\r\n        } catch (error) {\r\n            console.error(\"Error in fetchProfileData:\", error)\r\n            return null\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        let mounted = true\r\n\r\n        async function getSession() {\r\n            setLoading(true)\r\n\r\n            try {\r\n                const { data: { session } } = await supabase.auth.getSession()\r\n\r\n                if (session?.user) {\r\n                    const profileData = await fetchProfileData(session.user.id)\r\n\r\n                    console.log(\"Profile Data Loaded:\", profileData) // Debug log\r\n\r\n                    if (mounted) {\r\n                        if (profileData) {\r\n                            setProfile(profileData)\r\n\r\n                            // Check suspension\r\n                            if (profileData.deletion_scheduled_at) {\r\n                                const deletionDate = new Date(profileData.deletion_scheduled_at)\r\n                                if (deletionDate > new Date()) {\r\n                                    setIsDeletionScheduled(true)\r\n                                    setDeletionDate(profileData.deletion_scheduled_at)\r\n                                } else {\r\n                                    setIsDeletionScheduled(false)\r\n                                    setDeletionDate(null)\r\n                                }\r\n                            } else {\r\n                                setIsDeletionScheduled(false)\r\n                                setDeletionDate(null)\r\n                            }\r\n                        }\r\n                        setUser(session.user)\r\n                        setSession(session)\r\n                    }\r\n                } else {\r\n                    if (mounted) {\r\n                        setSession(null)\r\n                        setUser(null)\r\n                        setProfile(null)\r\n                        setIsDeletionScheduled(false)\r\n                        setDeletionDate(null)\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Error getting session:\", error)\r\n            } finally {\r\n                if (mounted) setLoading(false)\r\n            }\r\n        }\r\n\r\n        getSession()\r\n\r\n        const {\r\n            data: { subscription },\r\n        } = supabase.auth.onAuthStateChange((_event, _session) => {\r\n            // Prevent unnecessary re-renders/loading state on tab switch or token refresh\r\n            if ((_event === \"SIGNED_IN\" || _event === \"TOKEN_REFRESHED\") && _session?.user?.id === userRef.current?.id) {\r\n                setSession(_session)\r\n                return\r\n            }\r\n\r\n            if (_event === \"SIGNED_OUT\") {\r\n                setIsDeletionScheduled(false)\r\n                setDeletionDate(null)\r\n                setUser(null)\r\n                setSession(null)\r\n                setProfile(null)\r\n                setLoading(false)\r\n            } else if (_event === \"SIGNED_IN\" || _event === \"TOKEN_REFRESHED\") {\r\n                getSession()\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            mounted = false\r\n            subscription.unsubscribe()\r\n        }\r\n    }, [fetchProfileData])\r\n\r\n    const signOut = async () => {\r\n        await supabase.auth.signOut()\r\n        setIsDeletionScheduled(false)\r\n        setDeletionDate(null)\r\n        setProfile(null)\r\n    }\r\n\r\n    const refreshProfile = useCallback(async () => {\r\n        if (!user) return\r\n\r\n        const profileData = await fetchProfileData(user.id)\r\n        if (profileData) {\r\n            console.log(\"Profile Refreshed:\", profileData) // Debug log\r\n            setProfile(profileData)\r\n        }\r\n    }, [user, fetchProfileData])\r\n\r\n    const value = useMemo(() => ({\r\n        session,\r\n        user,\r\n        profile,\r\n        loading,\r\n        isDeletionScheduled,\r\n        deletionDate,\r\n        signOut,\r\n        refreshProfile\r\n    }), [session, user, profile, loading, isDeletionScheduled, deletionDate, refreshProfile])\r\n\r\n    return (\r\n        <AuthContext.Provider value={value}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\nexport const useAuth = () => useContext(AuthContext)\r\n\r\nimport { Navigate } from \"react-router-dom\"\r\n\r\nexport function PrivateRoute({ children }: { children: React.ReactNode }) {\r\n    const { user, loading } = useAuth()\r\n\r\n    if (loading) {\r\n        return <div className=\"flex h-screen items-center justify-center\">Carregando...</div>\r\n    }\r\n\r\n    if (!user) {\r\n        return <Navigate to=\"/login\" replace />\r\n    }\r\n\r\n    return <>{children}</>\r\n}\r\n\r\nexport function ActiveAccountRoute({ children }: { children: React.ReactNode }) {\r\n    const { user, loading, isDeletionScheduled } = useAuth()\r\n\r\n    if (loading) {\r\n        return <div className=\"flex h-screen items-center justify-center\">Carregando...</div>\r\n    }\r\n\r\n    if (!user) {\r\n        return <Navigate to=\"/login\" replace />\r\n    }\r\n\r\n    if (isDeletionScheduled) {\r\n        return <Navigate to=\"/recovery\" replace />\r\n    }\r\n\r\n    return <>{children}</>\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\contexts\\ProjectContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":115,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":115,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState, ReactNode, useCallback } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { Project } from \"@/types\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\n\r\ninterface ProjectContextType {\r\n    projects: Project[];\r\n    selectedProject: Project | null;\r\n    loading: boolean;\r\n    selectProject: (project: Project | null) => void;\r\n    createProject: (name: string, color?: string) => Promise<void>;\r\n    refreshProjects: () => Promise<void>;\r\n}\r\n\r\nconst ProjectContext = createContext<ProjectContextType>({\r\n    projects: [],\r\n    selectedProject: null,\r\n    loading: true,\r\n    selectProject: () => { },\r\n    createProject: async () => { },\r\n    refreshProjects: async () => { },\r\n});\r\n\r\nexport function ProjectProvider({ children }: { children: ReactNode }) {\r\n    const { user, profile } = useAuth();\r\n    const { toast } = useToast();\r\n    const [projects, setProjects] = useState<Project[]>([]);\r\n    const [selectedProject, setSelectedProject] = useState<Project | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Security Check: Force FREE users out of paid projects\r\n    useEffect(() => {\r\n        if (profile?.subscription_tier === 'FREE' && selectedProject !== null) {\r\n            setSelectedProject(null);\r\n            toast({\r\n                title: \"Plano Expirado\",\r\n                description: \"Seu plano expirou. Voltando para o perfil Pessoal.\",\r\n                variant: \"destructive\",\r\n            });\r\n        }\r\n    }, [profile, selectedProject, toast]);\r\n\r\n    const fetchProjects = useCallback(async () => {\r\n        if (!user) {\r\n            setProjects([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"projects\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", user.id)\r\n                .order(\"created_at\", { ascending: false });\r\n\r\n            if (error) throw error;\r\n\r\n            setProjects(data || []);\r\n        } catch (error) {\r\n            console.error(\"Error fetching projects:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user]);\r\n\r\n    useEffect(() => {\r\n        fetchProjects();\r\n    }, [user, fetchProjects]);\r\n\r\n    const selectProject = (project: Project | null) => {\r\n        setSelectedProject(project);\r\n    };\r\n\r\n    const createProject = async (name: string, color?: string) => {\r\n        if (!user) return;\r\n\r\n        try {\r\n            const { error } = await supabase\r\n                .from(\"projects\")\r\n                .insert([\r\n                    {\r\n                        name,\r\n                        color,\r\n                        user_id: user.id,\r\n                    },\r\n                ]);\r\n\r\n            if (error) throw error;\r\n\r\n            await fetchProjects();\r\n        } catch (error) {\r\n            console.error(\"Error creating project:\", error);\r\n            throw error;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <ProjectContext.Provider\r\n            value={{\r\n                projects,\r\n                selectedProject,\r\n                loading,\r\n                selectProject,\r\n                createProject,\r\n                refreshProjects: fetchProjects,\r\n            }}\r\n        >\r\n            {children}\r\n        </ProjectContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useProject = () => useContext(ProjectContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\hooks\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\hooks\\useDashboardWidgets.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\hooks\\useInvestment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\hooks\\useRecurrenceCheck.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\AccountRecovery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\AnalyticsPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":50,"column":8,"nodeType":"ArrayExpression","endLine":50,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData, user]","fix":{"range":[1843,1849],"text":"[fetchData, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useMemo } from \"react\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport { useProject } from \"@/contexts/ProjectContext\"\r\nimport { useNavigate } from \"react-router-dom\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { MonthSelector } from \"@/components/MonthSelector\"\r\nimport { UpgradeModal } from \"@/components/UpgradeModal\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport {\r\n    PieChart, Pie, Cell, ResponsiveContainer, Tooltip as RechartsTooltip, Legend,\r\n    XAxis, YAxis, CartesianGrid, AreaChart, Area\r\n} from \"recharts\"\r\nimport { Project, Transaction } from \"@/types\"\r\nimport { Loader2, TrendingUp, TrendingDown, Wallet, DollarSign } from \"lucide-react\"\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\"\r\nimport { subMonths, eachMonthOfInterval, format, startOfMonth, endOfMonth } from \"date-fns\"\r\nimport { ptBR } from \"date-fns/locale\"\r\n\r\ninterface AnalyticsData {\r\n    contextName: string\r\n    contextId: string\r\n    color: string\r\n    income: number\r\n    expense: number\r\n    balance: number // Accumulated\r\n    monthResult: number\r\n}\r\n\r\nexport function AnalyticsPage() {\r\n    const { user, profile } = useAuth()\r\n    const { selectProject } = useProject()\r\n    const navigate = useNavigate()\r\n    const [currentDate, setCurrentDate] = useState(new Date())\r\n    const [loading, setLoading] = useState(true)\r\n    const [projects, setProjects] = useState<Project[]>([])\r\n    const [transactions, setTransactions] = useState<Transaction[]>([])\r\n    const [isUpgradeModalOpen, setIsUpgradeModalOpen] = useState(false)\r\n\r\n    useEffect(() => {\r\n        fetchData()\r\n    }, [user])\r\n\r\n    const fetchData = async () => {\r\n        if (!user) return\r\n\r\n        try {\r\n            setLoading(true)\r\n\r\n            // Fetch Projects\r\n            const { data: projectsData, error: projectsError } = await supabase\r\n                .from(\"projects\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", user.id)\r\n\r\n            if (projectsError) throw projectsError\r\n\r\n            // Fetch All Transactions (for accumulated balance)\r\n            const { data: transactionsData, error: transactionsError } = await supabase\r\n                .from(\"transactions\")\r\n                .select(\"*\")\r\n                .eq(\"user_id\", user.id)\r\n\r\n            if (transactionsError) throw transactionsError\r\n\r\n            setProjects(projectsData || [])\r\n            setTransactions(transactionsData || [])\r\n\r\n        } catch (error) {\r\n            console.error(\"Error fetching analytics data:\", error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    // 1. Current Month Data (KPIs)\r\n    const currentMonthData = useMemo(() => {\r\n        const start = startOfMonth(currentDate)\r\n        const end = endOfMonth(currentDate)\r\n\r\n        // Group by Project ID\r\n        const groupedData: Record<string, AnalyticsData> = {}\r\n\r\n        // Initialize groups\r\n        groupedData[\"personal\"] = {\r\n            contextName: \"Pessoal\",\r\n            contextId: \"personal\",\r\n            color: \"#3b82f6\",\r\n            income: 0,\r\n            expense: 0,\r\n            balance: 0,\r\n            monthResult: 0\r\n        }\r\n\r\n        projects.forEach(p => {\r\n            groupedData[p.id] = {\r\n                contextName: p.name,\r\n                contextId: p.id,\r\n                color: p.color || \"#64748b\",\r\n                income: 0,\r\n                expense: 0,\r\n                balance: 0,\r\n                monthResult: 0\r\n            }\r\n        })\r\n\r\n        // Process Transactions\r\n        transactions.forEach(t => {\r\n            const key = t.project_id || \"personal\"\r\n            if (!groupedData[key]) return\r\n\r\n            const amount = Number(t.valor)\r\n            const isIncome = t.tipo === \"receita\"\r\n            const tDate = new Date(t.data)\r\n\r\n            // Accumulated Balance (All time)\r\n            if (isIncome) {\r\n                groupedData[key].balance += amount\r\n            } else {\r\n                groupedData[key].balance -= amount\r\n            }\r\n\r\n            // Month Data\r\n            if (tDate >= start && tDate <= end) {\r\n                if (isIncome) {\r\n                    groupedData[key].income += amount\r\n                } else {\r\n                    groupedData[key].expense += amount\r\n                }\r\n                groupedData[key].monthResult = groupedData[key].income - groupedData[key].expense\r\n            }\r\n        })\r\n\r\n        return Object.values(groupedData)\r\n    }, [transactions, projects, currentDate])\r\n\r\n    // 2. Previous Month Data (MoM Trends)\r\n    const kpiTrends = useMemo(() => {\r\n        const prevDate = subMonths(currentDate, 1)\r\n        const startPrev = startOfMonth(prevDate)\r\n        const endPrev = endOfMonth(prevDate)\r\n\r\n        let prevIncome = 0\r\n        let prevExpense = 0\r\n\r\n        transactions.forEach(t => {\r\n            const tDate = new Date(t.data)\r\n            if (tDate >= startPrev && tDate <= endPrev) {\r\n                const amount = Number(t.valor)\r\n                if (t.tipo === \"receita\") {\r\n                    prevIncome += amount\r\n                } else {\r\n                    prevExpense += amount\r\n                }\r\n            }\r\n        })\r\n\r\n        const prevResult = prevIncome - prevExpense\r\n\r\n        const currentIncome = currentMonthData.reduce((acc, curr) => acc + curr.income, 0)\r\n        const currentExpense = currentMonthData.reduce((acc, curr) => acc + curr.expense, 0)\r\n        const currentResult = currentIncome - currentExpense\r\n\r\n        const calculateTrend = (current: number, previous: number) => {\r\n            if (previous === 0) return current > 0 ? 100 : 0\r\n            return ((current - previous) / previous) * 100\r\n        }\r\n\r\n        return {\r\n            income: calculateTrend(currentIncome, prevIncome),\r\n            expense: calculateTrend(currentExpense, prevExpense),\r\n            result: calculateTrend(currentResult, prevResult)\r\n        }\r\n    }, [transactions, currentMonthData, currentDate])\r\n\r\n    // 3. History Data (Last 6 Months)\r\n    const historyData = useMemo(() => {\r\n        const months = eachMonthOfInterval({\r\n            start: subMonths(currentDate, 5),\r\n            end: currentDate\r\n        })\r\n\r\n        return months.map(month => {\r\n            const start = startOfMonth(month)\r\n            const end = endOfMonth(month)\r\n            let income = 0\r\n            let expense = 0\r\n\r\n            transactions.forEach(t => {\r\n                const tDate = new Date(t.data)\r\n                if (tDate >= start && tDate <= end) {\r\n                    const amount = Number(t.valor)\r\n                    if (t.tipo === \"receita\") {\r\n                        income += amount\r\n                    } else {\r\n                        expense += amount\r\n                    }\r\n                }\r\n            })\r\n\r\n            return {\r\n                month: format(month, \"MMM\", { locale: ptBR }),\r\n                receita: income,\r\n                lucro: income - expense\r\n            }\r\n        })\r\n    }, [transactions, currentDate])\r\n\r\n    // KPIs\r\n    const totalPatrimony = currentMonthData.reduce((acc, curr) => acc + curr.balance, 0)\r\n    const globalIncome = currentMonthData.reduce((acc, curr) => acc + curr.income, 0)\r\n    const globalExpense = currentMonthData.reduce((acc, curr) => acc + curr.expense, 0)\r\n    const globalResult = globalIncome - globalExpense\r\n\r\n    // Charts Data\r\n    const pieData = currentMonthData\r\n        .filter(d => d.balance > 0)\r\n        .map(d => ({ name: d.contextName, value: d.balance, color: d.color }))\r\n\r\n    const formatCurrency = (value: number) => {\r\n        return new Intl.NumberFormat(\"pt-BR\", {\r\n            style: \"currency\",\r\n            currency: \"BRL\",\r\n        }).format(value)\r\n    }\r\n\r\n    const formatPercent = (value: number) => {\r\n        return new Intl.NumberFormat(\"pt-BR\", {\r\n            style: \"percent\",\r\n            maximumFractionDigits: 1,\r\n            signDisplay: \"exceptZero\"\r\n        }).format(value / 100)\r\n    }\r\n\r\n    const handleRowClick = (contextId: string) => {\r\n        if (contextId === \"personal\") {\r\n            selectProject(null)\r\n        } else {\r\n            const project = projects.find(p => p.id === contextId)\r\n            if (project) {\r\n                selectProject(project)\r\n            }\r\n        }\r\n        navigate(\"/\")\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-full items-center justify-center p-8\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (profile?.subscription_tier === 'FREE') {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center h-full p-8 text-center\">\r\n                <h2 className=\"text-2xl font-bold\">Funcionalidade PRO 🚀</h2>\r\n                <p className=\"mb-4 text-muted-foreground\">O Analytics Global está disponível apenas para assinantes.</p>\r\n                <Button onClick={() => setIsUpgradeModalOpen(true)}>Fazer Upgrade</Button>\r\n                <UpgradeModal open={isUpgradeModalOpen} onOpenChange={setIsUpgradeModalOpen} />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <h1 className=\"text-3xl font-bold\">Inteligência Financeira</h1>\r\n                <MonthSelector currentDate={currentDate} onMonthChange={setCurrentDate} />\r\n            </div>\r\n\r\n            {/* KPI Cards with Trends */}\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Patrimônio Total</CardTitle>\r\n                        <Wallet className=\"h-4 w-4 text-blue-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-blue-600\">{formatCurrency(totalPatrimony)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">Acumulado Geral</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Receita Global</CardTitle>\r\n                        <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-green-600\">{formatCurrency(globalIncome)}</div>\r\n                        <div className=\"flex items-center gap-1 mt-1\">\r\n                            {kpiTrends.income > 0 ? <TrendingUp className=\"h-3 w-3 text-green-500\" /> : <TrendingDown className=\"h-3 w-3 text-red-500\" />}\r\n                            <span className={`text-xs ${kpiTrends.income > 0 ? \"text-green-500\" : \"text-red-500\"}`}>\r\n                                {formatPercent(kpiTrends.income)} vs mês anterior\r\n                            </span>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Despesa Global</CardTitle>\r\n                        <TrendingDown className=\"h-4 w-4 text-red-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-red-600\">{formatCurrency(globalExpense)}</div>\r\n                        <div className=\"flex items-center gap-1 mt-1\">\r\n                            {kpiTrends.expense < 0 ? <TrendingDown className=\"h-3 w-3 text-green-500\" /> : <TrendingUp className=\"h-3 w-3 text-red-500\" />}\r\n                            <span className={`text-xs ${kpiTrends.expense < 0 ? \"text-green-500\" : \"text-red-500\"}`}>\r\n                                {formatPercent(kpiTrends.expense)} vs mês anterior\r\n                            </span>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Resultado</CardTitle>\r\n                        <DollarSign className=\"h-4 w-4 text-purple-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className={`text-2xl font-bold ${globalResult >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\r\n                            {formatCurrency(globalResult)}\r\n                        </div>\r\n                        <div className=\"flex items-center gap-1 mt-1\">\r\n                            {kpiTrends.result > 0 ? <TrendingUp className=\"h-3 w-3 text-green-500\" /> : <TrendingDown className=\"h-3 w-3 text-red-500\" />}\r\n                            <span className={`text-xs ${kpiTrends.result > 0 ? \"text-green-500\" : \"text-red-500\"}`}>\r\n                                {formatPercent(kpiTrends.result)} vs mês anterior\r\n                            </span>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Evolution Chart */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Evolução Financeira (Últimos 6 Meses)</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"h-[300px]\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                        <AreaChart data={historyData} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>\r\n                            <defs>\r\n                                <linearGradient id=\"colorReceita\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                    <stop offset=\"5%\" stopColor=\"#8b5cf6\" stopOpacity={0.8} />\r\n                                    <stop offset=\"95%\" stopColor=\"#8b5cf6\" stopOpacity={0} />\r\n                                </linearGradient>\r\n                                <linearGradient id=\"colorLucro\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                    <stop offset=\"5%\" stopColor=\"#10b981\" stopOpacity={0.8} />\r\n                                    <stop offset=\"95%\" stopColor=\"#10b981\" stopOpacity={0} />\r\n                                </linearGradient>\r\n                            </defs>\r\n                            <XAxis dataKey=\"month\" />\r\n                            <YAxis tickFormatter={(value) => `R$ ${value / 1000}k`} />\r\n                            <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\r\n                            <RechartsTooltip\r\n                                contentStyle={{ backgroundColor: \"hsl(var(--popover))\", borderColor: \"hsl(var(--border))\", color: \"hsl(var(--popover-foreground))\" }}\r\n                                formatter={(value: number) => formatCurrency(value)}\r\n                            />\r\n                            <Area type=\"linear\" dataKey=\"receita\" stroke=\"#8b5cf6\" fillOpacity={1} fill=\"url(#colorReceita)\" name=\"Receita\" />\r\n                            <Area type=\"linear\" dataKey=\"lucro\" stroke=\"#10b981\" fillOpacity={1} fill=\"url(#colorLucro)\" name=\"Lucro\" />\r\n                        </AreaChart>\r\n                    </ResponsiveContainer>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Distribuição de Patrimônio</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent className=\"h-[300px]\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <PieChart>\r\n                                <Pie\r\n                                    data={pieData}\r\n                                    cx=\"50%\"\r\n                                    cy=\"50%\"\r\n                                    innerRadius={60}\r\n                                    outerRadius={80}\r\n                                    paddingAngle={5}\r\n                                    dataKey=\"value\"\r\n                                >\r\n                                    {pieData.map((entry, index) => (\r\n                                        <Cell key={`cell-${index}`} fill={entry.color} />\r\n                                    ))}\r\n                                </Pie>\r\n                                <RechartsTooltip formatter={(value: number) => formatCurrency(value)} />\r\n                                <Legend />\r\n                            </PieChart>\r\n                        </ResponsiveContainer>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                {/* Detailed Table with Margins */}\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Detalhamento de Performance</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <Table>\r\n                            <TableHeader>\r\n                                <TableRow>\r\n                                    <TableHead>Contexto</TableHead>\r\n                                    <TableHead className=\"text-right\">Receita</TableHead>\r\n                                    <TableHead className=\"text-right\">Resultado</TableHead>\r\n                                    <TableHead className=\"text-right\">Margem %</TableHead>\r\n                                </TableRow>\r\n                            </TableHeader>\r\n                            <TableBody>\r\n                                {currentMonthData.map((row) => {\r\n                                    const margin = row.income > 0 ? (row.monthResult / row.income) * 100 : 0\r\n                                    let badgeVariant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" = \"secondary\"\r\n                                    let badgeClass = \"\"\r\n\r\n                                    if (margin > 0) {\r\n                                        badgeVariant = \"default\"\r\n                                        badgeClass = \"bg-emerald-600 hover:bg-emerald-700\"\r\n                                    } else if (margin < 0) {\r\n                                        badgeVariant = \"destructive\"\r\n                                        badgeClass = \"bg-rose-600 hover:bg-rose-700\"\r\n                                    } else {\r\n                                        badgeVariant = \"secondary\"\r\n                                        badgeClass = \"bg-slate-200 dark:bg-slate-800 text-slate-600 dark:text-slate-400\"\r\n                                    }\r\n\r\n                                    return (\r\n                                        <TableRow\r\n                                            key={row.contextId}\r\n                                            className=\"cursor-pointer hover:bg-muted/50 transition-colors\"\r\n                                            onClick={() => handleRowClick(row.contextId)}\r\n                                        >\r\n                                            <TableCell className=\"font-medium\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <div className=\"h-3 w-3 rounded-full\" style={{ backgroundColor: row.color }} />\r\n                                                    {row.contextName}\r\n                                                </div>\r\n                                            </TableCell>\r\n                                            <TableCell className=\"text-right text-green-600\">{formatCurrency(row.income)}</TableCell>\r\n                                            <TableCell className={`text-right font-bold ${row.monthResult >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\r\n                                                {formatCurrency(row.monthResult)}\r\n                                            </TableCell>\r\n                                            <TableCell className=\"text-right\">\r\n                                                <Badge\r\n                                                    variant={badgeVariant}\r\n                                                    className={badgeClass}\r\n                                                >\r\n                                                    {formatPercent(margin)}\r\n                                                </Badge>\r\n                                            </TableCell>\r\n                                        </TableRow>\r\n                                    )\r\n                                })}\r\n                            </TableBody>\r\n                        </Table>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Categories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Dashboard.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":50,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":50,"endColumn":63,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[2200,2254],"text":"// @ts-expect-error - chart_type is guaranteed by the dialog"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { useInvestment } from \"@/hooks/useInvestment\"\r\nimport { DollarSign, TrendingDown, TrendingUp, Wallet, ArrowRightLeft, Edit, Save, Plus, Lock } from \"lucide-react\"\r\n\r\nimport { NewTransactionModal } from \"@/components/NewTransactionModal\"\r\nimport { NewTransferModal } from \"@/components/NewTransferModal\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { useRecurrenceCheck } from \"@/hooks/useRecurrenceCheck\"\r\n\r\nimport { useState } from \"react\"\r\nimport { MonthSelector } from \"@/components/MonthSelector\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport { DashboardGrid } from \"@/components/dashboard/DashboardGrid\"\r\nimport { useDashboardWidgets } from \"@/hooks/useDashboardWidgets\"\r\nimport { AddWidgetDialog } from \"@/components/dashboard/AddWidgetDialog\"\r\nimport { DashboardWidget } from \"@/types/dashboard\"\r\nimport { UpgradeModal } from \"@/components/UpgradeModal\"\r\n\r\nexport function Dashboard() {\r\n    const [currentDate, setCurrentDate] = useState(new Date())\r\n    const [isTransferModalOpen, setIsTransferModalOpen] = useState(false)\r\n    const { income, expense, balance, investment, loading, refetch, fixedExpenses, variableExpenses } = useInvestment(currentDate)\r\n    useRecurrenceCheck(refetch)\r\n\r\n    const { profile } = useAuth()\r\n    const isPro = profile?.subscription_tier === 'PRO'\r\n\r\n    // Dashboard Widgets Hook\r\n    const { widgets, loading: widgetsLoading, saveLayout, addWidget, deleteWidget } = useDashboardWidgets()\r\n    const [isEditing, setIsEditing] = useState(false)\r\n    const [isAddWidgetOpen, setIsAddWidgetOpen] = useState(false)\r\n    const [isUpgradeModalOpen, setIsUpgradeModalOpen] = useState(false)\r\n\r\n    const formatCurrency = (value: number) => {\r\n        return new Intl.NumberFormat(\"pt-BR\", {\r\n            style: \"currency\",\r\n            currency: \"BRL\",\r\n        }).format(value)\r\n    }\r\n\r\n    const handleAddWidgetClick = () => {\r\n        if (isPro) {\r\n            setIsAddWidgetOpen(true);\r\n        } else {\r\n            setIsUpgradeModalOpen(true);\r\n        }\r\n    };\r\n\r\n    const handleAddWidget = (widget: Partial<DashboardWidget>) => {\r\n        // @ts-ignore - chart_type is guaranteed by the dialog\r\n        addWidget(widget);\r\n    };\r\n\r\n    if (loading) {\r\n        return <div className=\"p-8\">Carregando...</div>\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <h1 className=\"text-3xl font-bold\">Dashboard</h1>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <MonthSelector currentDate={currentDate} onMonthChange={setCurrentDate} />\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        className=\"gap-2\"\r\n                        onClick={() => setIsTransferModalOpen(true)}\r\n                    >\r\n                        <ArrowRightLeft className=\"h-4 w-4\" />\r\n                        Transferir Fundos\r\n                    </Button>\r\n                    <NewTransferModal\r\n                        open={isTransferModalOpen}\r\n                        onOpenChange={setIsTransferModalOpen}\r\n                        onSuccess={refetch}\r\n                    />\r\n                    <NewTransactionModal onSuccess={refetch} />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Receita Total</CardTitle>\r\n                        <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-green-600\">{formatCurrency(income)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">no mês atual</p>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Despesa Total</CardTitle>\r\n                        <TrendingDown className=\"h-4 w-4 text-red-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-red-600\">{formatCurrency(expense)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">no mês atual</p>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Saldo</CardTitle>\r\n                        <Wallet className=\"h-4 w-4 text-blue-500\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className={`text-2xl font-bold ${balance >= 0 ? \"text-blue-600\" : \"text-red-600\"}`}>\r\n                            {formatCurrency(balance)}\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground\">no mês atual</p>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                <Card className=\"bg-primary/5 border-primary/20\">\r\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                        <CardTitle className=\"text-sm font-medium\">Destinado a Investimento</CardTitle>\r\n                        <DollarSign className=\"h-4 w-4 text-primary\" />\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"text-2xl font-bold text-primary\">{formatCurrency(investment)}</div>\r\n                        <p className=\"text-xs text-muted-foreground\">sugestão baseada no perfil</p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Customizable Dashboard Section */}\r\n            <div className=\"mt-8 space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <h2 className=\"text-xl font-bold\">Seu Painel</h2>\r\n                        {!isPro && (\r\n                            <span className=\"px-2 py-1 text-xs font-semibold text-amber-700 bg-amber-100 rounded-full border border-amber-200 flex items-center gap-1\">\r\n                                <Lock className=\"h-3 w-3\" />\r\n                                Modo Leitura (Free)\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {isPro && (\r\n                            <Button\r\n                                variant={isEditing ? \"default\" : \"outline\"}\r\n                                onClick={() => setIsEditing(!isEditing)}\r\n                                className=\"gap-2\"\r\n                            >\r\n                                {isEditing ? <Save className=\"h-4 w-4\" /> : <Edit className=\"h-4 w-4\" />}\r\n                                {isEditing ? \"Concluir Edição\" : \"Editar Dashboard\"}\r\n                            </Button>\r\n                        )}\r\n\r\n                        {(isEditing || !isPro) && (\r\n                            <Button className=\"gap-2\" onClick={handleAddWidgetClick}>\r\n                                <Plus className=\"h-4 w-4\" />\r\n                                Adicionar Widget\r\n                                {!isPro && <Lock className=\"h-3 w-3 ml-1 opacity-70\" />}\r\n                            </Button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-background rounded-lg border min-h-[500px]\">\r\n                    {widgetsLoading ? (\r\n                        <div className=\"flex items-center justify-center h-[400px]\">Carregando widgets...</div>\r\n                    ) : widgets.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center h-[400px] text-muted-foreground\">\r\n                            <p className=\"mb-4\">Nenhum widget encontrado.</p>\r\n                            {isPro ? (\r\n                                <Button onClick={() => setIsAddWidgetOpen(true)} variant=\"outline\">\r\n                                    Adicionar seu primeiro widget\r\n                                </Button>\r\n                            ) : (\r\n                                <p className=\"text-sm\">Widgets padrão serão carregados em breve...</p>\r\n                            )}\r\n                        </div>\r\n                    ) : (\r\n                        <DashboardGrid\r\n                            widgets={widgets}\r\n                            isEditing={isEditing}\r\n                            isEditable={!!isPro}\r\n                            onLayoutChange={saveLayout}\r\n                            onDeleteWidget={deleteWidget}\r\n                            fixedExpenses={fixedExpenses}\r\n                            variableExpenses={variableExpenses}\r\n                        />\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <AddWidgetDialog\r\n                open={isAddWidgetOpen}\r\n                onOpenChange={setIsAddWidgetOpen}\r\n                onAdd={handleAddWidget}\r\n            />\r\n\r\n            <UpgradeModal\r\n                open={isUpgradeModalOpen}\r\n                onOpenChange={setIsUpgradeModalOpen}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\InvestmentsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":187,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5666,5669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5666,5669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'current' is never reassigned. Use 'const' instead.","line":192,"column":21,"nodeType":"Identifier","messageId":"useConst","endLine":192,"endColumn":28,"fix":{"range":[5927,6009],"text":"const current = monthlyMap.get(monthKey) || { income: 0, expense: 0, investment: 0 }"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9970,9973],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9970,9973],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":348,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11940,11943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11940,11943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport { useProject } from \"@/contexts/ProjectContext\"\r\nimport { MonthSelector } from \"@/components/MonthSelector\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Progress } from \"@/components/ui/progress\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\"\r\nimport { TrendingUp, TrendingDown, DollarSign, Plus, Loader2, LineChart } from \"lucide-react\"\r\nimport { NewTransactionModal } from \"@/components/NewTransactionModal\"\r\nimport { NewGoalModal } from \"@/components/NewGoalModal\"\r\nimport { GoalCard } from \"@/components/GoalCard\"\r\nimport {\r\n    AreaChart,\r\n    Area,\r\n    XAxis,\r\n    YAxis,\r\n    CartesianGrid,\r\n    Tooltip,\r\n    ResponsiveContainer,\r\n    Legend\r\n} from \"recharts\"\r\n\r\ninterface InvestmentTransaction {\r\n    id: string\r\n    descricao: string\r\n    valor: number\r\n    data: string\r\n    categories: {\r\n        nome: string\r\n        cor: string\r\n    }\r\n}\r\n\r\ninterface GroupedInvestment {\r\n    categoryName: string\r\n    categoryColor: string\r\n    total: number\r\n    transactions: InvestmentTransaction[]\r\n}\r\n\r\ninterface MonthlyHistory {\r\n    month: string // YYYY-MM\r\n    displayMonth: string // MMM/YY\r\n    income: number\r\n    expense: number // Regular expense\r\n    investment: number\r\n    goal: number\r\n    accumulatedGoal: number\r\n    accumulatedRealized: number\r\n}\r\n\r\ninterface Category {\r\n    id: string\r\n    nome: string\r\n    cor: string\r\n    is_investment?: boolean\r\n    goal_id?: string | null\r\n}\r\n\r\ninterface Goal {\r\n    id: string\r\n    title: string\r\n    target_amount: number\r\n    deadline: string\r\n    categories: Category[]\r\n}\r\n\r\nexport function InvestmentsPage() {\r\n    const { user } = useAuth()\r\n    const { selectedProject } = useProject()\r\n    const [currentDate, setCurrentDate] = useState(new Date())\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    // Monthly View State\r\n    const [goal, setGoal] = useState(0)\r\n    const [realized, setRealized] = useState(0)\r\n    const [investments, setInvestments] = useState<GroupedInvestment[]>([])\r\n\r\n    // Historical/All-Time State\r\n    const [historicalData, setHistoricalData] = useState<MonthlyHistory[]>([])\r\n    const [totalAccumulatedGoal, setTotalAccumulatedGoal] = useState(0)\r\n    const [totalAccumulatedRealized, setTotalAccumulatedRealized] = useState(0)\r\n    const [performance, setPerformance] = useState(0)\r\n\r\n    const [isModalOpen, setIsModalOpen] = useState(false)\r\n    const [defaultCategoryId, setDefaultCategoryId] = useState<string>(\"\")\r\n\r\n    // Goals State\r\n    const [goals, setGoals] = useState<Goal[]>([])\r\n    const [editingGoal, setEditingGoal] = useState<Goal | null>(null)\r\n    const [isGoalModalOpen, setIsGoalModalOpen] = useState(false)\r\n\r\n    const fetchGoals = useCallback(async () => {\r\n        if (!user) return\r\n        try {\r\n            let query = supabase\r\n                .from(\"goals\")\r\n                .select(`\r\n                    *,\r\n                    categories (\r\n                        id,\r\n                        nome,\r\n                        cor,\r\n                        is_investment,\r\n                        goal_id\r\n                    )\r\n                `)\r\n                .eq(\"user_id\", user.id)\r\n                .order(\"deadline\", { ascending: true })\r\n\r\n            if (selectedProject) {\r\n                query = query.eq(\"project_id\", selectedProject.id)\r\n            } else {\r\n                query = query.is(\"project_id\", null)\r\n            }\r\n\r\n            const { data, error } = await query\r\n\r\n            if (error) throw error\r\n            setGoals(data || [])\r\n        } catch (err) {\r\n            console.error(\"Error fetching goals:\", err)\r\n        }\r\n    }, [user, selectedProject])\r\n\r\n    const handleEditGoal = (goal: Goal) => {\r\n        setEditingGoal(goal)\r\n        setIsGoalModalOpen(true)\r\n    }\r\n\r\n    const handleGoalSuccess = () => {\r\n        fetchGoals()\r\n        setEditingGoal(null)\r\n    }\r\n\r\n    const fetchHistoricalData = useCallback(async () => {\r\n        if (!user) return\r\n\r\n        try {\r\n            // Fetch Profile for Goal Settings\r\n            const { data: profile } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"investimento_percentual, investimento_base\")\r\n                .eq(\"user_id\", user.id)\r\n                .single()\r\n\r\n            const percent = Number(profile?.investimento_percentual || 0) / 100\r\n            const base = profile?.investimento_base || \"SOBRA\"\r\n\r\n            // Fetch ALL transactions with categories\r\n            let query = supabase\r\n                .from(\"transactions\")\r\n                .select(`\r\n                    id,\r\n                    valor,\r\n                    tipo,\r\n                    data,\r\n                    categories (\r\n                        is_investment\r\n                    )\r\n                `)\r\n                .eq(\"user_id\", user.id)\r\n                .order(\"data\", { ascending: true })\r\n\r\n            if (selectedProject) {\r\n                query = query.eq(\"project_id\", selectedProject.id)\r\n            } else {\r\n                query = query.is(\"project_id\", null)\r\n            }\r\n\r\n            const { data: allTxs, error } = await query\r\n\r\n            if (error) throw error\r\n\r\n            // Process Data\r\n            const monthlyMap = new Map<string, { income: number, expense: number, investment: number }>()\r\n\r\n            allTxs?.forEach((tx: any) => {\r\n                const date = new Date(tx.data)\r\n                // Use UTC to avoid timezone issues shifting the month\r\n                const monthKey = `${date.getUTCFullYear()}-${String(date.getUTCMonth() + 1).padStart(2, '0')}`\r\n\r\n                let current = monthlyMap.get(monthKey) || { income: 0, expense: 0, investment: 0 }\r\n\r\n                const val = Number(tx.valor)\r\n                const isInvestment = tx.categories?.is_investment\r\n\r\n                if (isInvestment) {\r\n                    // Assuming investment is usually an outflow (expense) or explicitly marked\r\n                    // We sum it as 'investment' regardless of type 'despesa'\r\n                    current.investment += val\r\n                } else {\r\n                    if (tx.tipo === \"receita\") {\r\n                        current.income += val\r\n                    } else if (tx.tipo === \"despesa\") {\r\n                        current.expense += val\r\n                    }\r\n                }\r\n                monthlyMap.set(monthKey, current)\r\n            })\r\n\r\n            // Calculate Goals and Accumulations\r\n            let accGoal = 0\r\n            let accRealized = 0\r\n            const history: MonthlyHistory[] = []\r\n\r\n            // Sort months chronologically\r\n            const sortedMonths = Array.from(monthlyMap.keys()).sort()\r\n\r\n            sortedMonths.forEach(monthKey => {\r\n                const data = monthlyMap.get(monthKey)!\r\n\r\n                // Calculate Monthly Goal\r\n                let monthlyGoal = 0\r\n                if (base === \"BRUTO\") {\r\n                    monthlyGoal = data.income * percent\r\n                } else {\r\n                    monthlyGoal = Math.max(0, (data.income - data.expense) * percent)\r\n                }\r\n\r\n                accGoal += monthlyGoal\r\n                accRealized += data.investment\r\n\r\n                const [year, month] = monthKey.split('-')\r\n                const dateObj = new Date(Number(year), Number(month) - 1)\r\n                const displayMonth = dateObj.toLocaleDateString('pt-BR', { month: 'short', year: '2-digit' })\r\n\r\n                history.push({\r\n                    month: monthKey,\r\n                    displayMonth: displayMonth.charAt(0).toUpperCase() + displayMonth.slice(1),\r\n                    income: data.income,\r\n                    expense: data.expense,\r\n                    investment: data.investment,\r\n                    goal: monthlyGoal,\r\n                    accumulatedGoal: accGoal,\r\n                    accumulatedRealized: accRealized\r\n                })\r\n            })\r\n\r\n            setHistoricalData(history)\r\n            setTotalAccumulatedGoal(accGoal)\r\n            setTotalAccumulatedRealized(accRealized)\r\n            setPerformance(accGoal > 0 ? (accRealized / accGoal) * 100 : 0)\r\n\r\n        } catch (err) {\r\n            console.error(\"Error fetching historical data:\", err)\r\n        }\r\n    }, [user, selectedProject])\r\n\r\n    const fetchMonthlyData = useCallback(async () => {\r\n        if (!user) return\r\n\r\n        try {\r\n            setLoading(true)\r\n            const startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).toISOString()\r\n            const endOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).toISOString()\r\n\r\n            // 1. Fetch Profile for Goal Calculation\r\n            const { data: profile } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"investimento_percentual, investimento_base\")\r\n                .eq(\"user_id\", user.id)\r\n                .single()\r\n\r\n            // 2. Fetch All Transactions for the Month (to calc income/expense for goal)\r\n            let txQuery = supabase\r\n                .from(\"transactions\")\r\n                .select(\"valor, tipo, categories(is_investment)\")\r\n                .eq(\"user_id\", user.id)\r\n                .gte(\"data\", startOfMonth)\r\n                .lte(\"data\", endOfMonth)\r\n\r\n            if (selectedProject) {\r\n                txQuery = txQuery.eq(\"project_id\", selectedProject.id)\r\n            } else {\r\n                txQuery = txQuery.is(\"project_id\", null)\r\n            }\r\n\r\n            const { data: allTransactions } = await txQuery\r\n\r\n            let income = 0\r\n            let expense = 0\r\n            allTransactions?.forEach((tx: any) => {\r\n                const isInv = tx.categories?.is_investment\r\n                if (!isInv) {\r\n                    if (tx.tipo === \"receita\") income += Number(tx.valor)\r\n                    if (tx.tipo === \"despesa\") expense += Number(tx.valor)\r\n                }\r\n            })\r\n\r\n            // Calculate Goal\r\n            let calculatedGoal = 0\r\n            const percent = Number(profile?.investimento_percentual || 0) / 100\r\n            const base = profile?.investimento_base || \"SOBRA\"\r\n\r\n            if (base === \"BRUTO\") {\r\n                calculatedGoal = income * percent\r\n            } else {\r\n                calculatedGoal = Math.max(0, (income - expense) * percent)\r\n            }\r\n            setGoal(calculatedGoal)\r\n\r\n            // 3. Fetch Investment Transactions\r\n            let invQuery = supabase\r\n                .from(\"transactions\")\r\n                .select(`\r\n                    id,\r\n                    descricao,\r\n                    valor,\r\n                    data,\r\n                    categoria_id,\r\n                    categories (\r\n                        id,\r\n                        nome,\r\n                        cor,\r\n                        is_investment\r\n                    )\r\n                `)\r\n                .eq(\"user_id\", user.id)\r\n                .gte(\"data\", startOfMonth)\r\n                .lte(\"data\", endOfMonth)\r\n                .order(\"data\", { ascending: false })\r\n\r\n            if (selectedProject) {\r\n                invQuery = invQuery.eq(\"project_id\", selectedProject.id)\r\n            } else {\r\n                invQuery = invQuery.is(\"project_id\", null)\r\n            }\r\n\r\n            const { data: investmentTxs, error } = await invQuery\r\n\r\n            if (error) throw error\r\n\r\n            // Filter and Group\r\n            let totalRealized = 0\r\n            const groupedMap = new Map<string, GroupedInvestment>()\r\n            let firstInvestmentCatId = \"\"\r\n\r\n            investmentTxs?.forEach((tx: any) => {\r\n                if (tx.categories?.is_investment) {\r\n                    const val = Number(tx.valor)\r\n                    totalRealized += val\r\n\r\n                    if (!firstInvestmentCatId) firstInvestmentCatId = tx.categories.id\r\n\r\n                    const catName = tx.categories.nome\r\n                    // Explicitly type the new object to match GroupedInvestment\r\n                    const current: GroupedInvestment = groupedMap.get(catName) || {\r\n                        categoryName: catName,\r\n                        categoryColor: tx.categories.cor,\r\n                        total: 0,\r\n                        transactions: []\r\n                    }\r\n\r\n                    current.total += val\r\n                    current.transactions.push({\r\n                        id: tx.id,\r\n                        descricao: tx.descricao,\r\n                        valor: val,\r\n                        data: tx.data,\r\n                        categories: tx.categories\r\n                    })\r\n                    groupedMap.set(catName, current)\r\n                }\r\n            })\r\n\r\n            setRealized(totalRealized)\r\n            setInvestments(Array.from(groupedMap.values()))\r\n\r\n            // If we didn't find any investment transaction, we should try to find ANY investment category to set as default\r\n            if (!firstInvestmentCatId) {\r\n                const { data: anyInvCat } = await supabase\r\n                    .from(\"categories\")\r\n                    .select(\"id\")\r\n                    .eq(\"user_id\", user.id)\r\n                    .eq(\"is_investment\", true)\r\n                    .limit(1)\r\n                    .single()\r\n\r\n                if (anyInvCat) firstInvestmentCatId = anyInvCat.id\r\n            }\r\n            setDefaultCategoryId(firstInvestmentCatId)\r\n\r\n        } catch (err) {\r\n            console.error(\"Error fetching investment data:\", err)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }, [user, currentDate, selectedProject])\r\n\r\n    useEffect(() => {\r\n        fetchHistoricalData()\r\n        fetchGoals()\r\n    }, [fetchHistoricalData, fetchGoals])\r\n\r\n    useEffect(() => {\r\n        fetchMonthlyData()\r\n    }, [fetchMonthlyData])\r\n\r\n    const formatCurrency = (value: number) => {\r\n        return new Intl.NumberFormat(\"pt-BR\", {\r\n            style: \"currency\",\r\n            currency: \"BRL\",\r\n        }).format(value)\r\n    }\r\n\r\n    const difference = realized - goal\r\n    const progress = goal > 0 ? Math.min(100, (realized / goal) * 100) : 0\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-screen w-full items-center justify-center bg-background\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n                <span className=\"ml-2 text-lg font-medium text-muted-foreground\">Carregando...</span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <h1 className=\"text-3xl font-bold\">Investimentos</h1>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <MonthSelector currentDate={currentDate} onMonthChange={setCurrentDate} />\r\n                    <NewTransactionModal\r\n                        open={isModalOpen}\r\n                        onOpenChange={setIsModalOpen}\r\n                        onSuccess={() => {\r\n                            fetchMonthlyData()\r\n                            fetchHistoricalData()\r\n                        }}\r\n                        defaultCategoryId={defaultCategoryId}\r\n                        isInvestmentMode={true}\r\n                    />\r\n                    <Button onClick={() => setIsModalOpen(true)} className=\"gap-2\">\r\n                        <Plus className=\"h-4 w-4\" />\r\n                        Novo Aporte\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Goals Section */}\r\n            <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <h2 className=\"text-xl font-semibold\">Metas Financeiras</h2>\r\n                    <Button variant=\"outline\" className=\"gap-2\" onClick={() => {\r\n                        setEditingGoal(null)\r\n                        setIsGoalModalOpen(true)\r\n                    }}>\r\n                        <Plus className=\"h-4 w-4\" />\r\n                        Nova Meta\r\n                    </Button>\r\n                    <NewGoalModal\r\n                        isOpen={isGoalModalOpen}\r\n                        onClose={() => setIsGoalModalOpen(false)}\r\n                        onSuccess={handleGoalSuccess}\r\n                        goalToEdit={editingGoal}\r\n                    />\r\n                </div>\r\n\r\n                {goals.length === 0 ? (\r\n                    <div className=\"text-center py-8 border rounded-md bg-muted/20\">\r\n                        <p className=\"text-muted-foreground\">Nenhuma meta cadastrada.</p>\r\n                        <p className=\"text-sm text-muted-foreground\">Crie uma meta para acompanhar seu progresso.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                        {goals.map(goal => (\r\n                            <GoalCard key={goal.id} goal={goal} onEdit={handleEditGoal} onDelete={handleGoalSuccess} />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* All-Time Summary */}\r\n            <div className=\"space-y-4\">\r\n                <h2 className=\"text-xl font-semibold\">Resumo Geral (All-Time)</h2>\r\n                <div className=\"grid gap-4 md:grid-cols-3\">\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Meta Acumulada</CardTitle>\r\n                            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"text-2xl font-bold\">{formatCurrency(totalAccumulatedGoal)}</div>\r\n                            <p className=\"text-xs text-muted-foreground\">Soma de todas as metas mensais</p>\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Acumulado Realizado</CardTitle>\r\n                            <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"text-2xl font-bold\">{formatCurrency(totalAccumulatedRealized)}</div>\r\n                            <p className=\"text-xs text-muted-foreground\">Soma de todos os aportes</p>\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Performance</CardTitle>\r\n                            <LineChart className=\"h-4 w-4 text-muted-foreground\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className={`text-2xl font-bold ${performance >= 100 ? \"text-green-600\" : \"text-yellow-600\"}`}>\r\n                                {performance.toFixed(1)}%\r\n                            </div>\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                {performance >= 100 ? \"Superou a meta!\" : \"Abaixo da meta acumulada\"}\r\n                            </p>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n\r\n                {/* Evolution Chart */}\r\n                <Card className=\"col-span-4\">\r\n                    <CardHeader>\r\n                        <CardTitle>Evolução Patrimonial</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent className=\"pl-2\">\r\n                        <div className=\"h-[300px] w-full\">\r\n                            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                                <AreaChart data={historicalData} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>\r\n                                    <defs>\r\n                                        <linearGradient id=\"colorRealized\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                                            <stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.8} />\r\n                                            <stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0} />\r\n                                        </linearGradient>\r\n                                    </defs>\r\n                                    <XAxis\r\n                                        dataKey=\"displayMonth\"\r\n                                        stroke=\"hsl(var(--muted-foreground))\"\r\n                                        fontSize={12}\r\n                                        tickLine={false}\r\n                                        axisLine={false}\r\n                                    />\r\n                                    <YAxis\r\n                                        tickFormatter={(value) => `R$ ${value}`}\r\n                                        stroke=\"hsl(var(--muted-foreground))\"\r\n                                        fontSize={12}\r\n                                        tickLine={false}\r\n                                        axisLine={false}\r\n                                    />\r\n                                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" vertical={false} />\r\n                                    <Tooltip\r\n                                        formatter={(value) => formatCurrency(Number(value))}\r\n                                        contentStyle={{\r\n                                            backgroundColor: 'hsl(var(--card))',\r\n                                            borderColor: 'hsl(var(--border))',\r\n                                            color: 'hsl(var(--foreground))',\r\n                                            borderRadius: 'var(--radius)'\r\n                                        }}\r\n                                        itemStyle={{ color: 'hsl(var(--foreground))' }}\r\n                                        labelStyle={{ color: 'hsl(var(--muted-foreground))' }}\r\n                                    />\r\n                                    <Legend />\r\n                                    <Area\r\n                                        type=\"monotone\"\r\n                                        dataKey=\"accumulatedGoal\"\r\n                                        name=\"Meta Acumulada\"\r\n                                        stroke=\"hsl(var(--muted-foreground))\"\r\n                                        fillOpacity={0}\r\n                                        strokeDasharray=\"5 5\"\r\n                                        strokeWidth={2}\r\n                                    />\r\n                                    <Area\r\n                                        type=\"monotone\"\r\n                                        dataKey=\"accumulatedRealized\"\r\n                                        name=\"Patrimônio Real\"\r\n                                        stroke=\"hsl(var(--primary))\"\r\n                                        fill=\"url(#colorRealized)\"\r\n                                        strokeWidth={2}\r\n                                    />\r\n                                </AreaChart>\r\n                            </ResponsiveContainer>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Monthly View */}\r\n            <div className=\"space-y-4 pt-8 border-t\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <h2 className=\"text-xl font-semibold\">Visão Mensal</h2>\r\n                    <MonthSelector currentDate={currentDate} onMonthChange={setCurrentDate} />\r\n                </div>\r\n\r\n                {/* Summary Cards */}\r\n                <div className=\"grid gap-4 md:grid-cols-3\">\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Meta do Mês</CardTitle>\r\n                            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"text-2xl font-bold\">{formatCurrency(goal)}</div>\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                Baseado no seu perfil\r\n                            </p>\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Aporte Realizado</CardTitle>\r\n                            <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className=\"text-2xl font-bold\">{formatCurrency(realized)}</div>\r\n                            <Progress value={progress} className=\"mt-2\" />\r\n                            <p className=\"text-xs text-muted-foreground mt-1\">\r\n                                {progress.toFixed(0)}% da meta\r\n                            </p>\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card>\r\n                        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                            <CardTitle className=\"text-sm font-medium\">Diferença</CardTitle>\r\n                            {difference >= 0 ? (\r\n                                <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                            ) : (\r\n                                <TrendingDown className=\"h-4 w-4 text-red-500\" />\r\n                            )}\r\n                        </CardHeader>\r\n                        <CardContent>\r\n                            <div className={`text-2xl font-bold ${difference >= 0 ? \"text-green-600\" : \"text-red-600\"}`}>\r\n                                {formatCurrency(difference)}\r\n                            </div>\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                                {difference >= 0 ? \"Meta atingida!\" : \"Falta para a meta\"}\r\n                            </p>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n\r\n                {/* Detailed List */}\r\n                <div className=\"space-y-4\">\r\n                    <h3 className=\"text-lg font-semibold\">Detalhamento por Categoria</h3>\r\n                    {investments.length === 0 ? (\r\n                        <div className=\"text-center text-muted-foreground py-8 border rounded-md\">\r\n                            Nenhum investimento encontrado neste mês.\r\n                        </div>\r\n                    ) : (\r\n                        investments.map((group) => (\r\n                            <Card key={group.categoryName}>\r\n                                <CardHeader className=\"pb-2\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <div\r\n                                                className=\"h-3 w-3 rounded-full\"\r\n                                                style={{ backgroundColor: group.categoryColor }}\r\n                                            />\r\n                                            <CardTitle className=\"text-lg\">{group.categoryName}</CardTitle>\r\n                                        </div>\r\n                                        <span className=\"font-bold\">{formatCurrency(group.total)}</span>\r\n                                    </div>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    <Table>\r\n                                        <TableHeader>\r\n                                            <TableRow>\r\n                                                <TableHead>Data</TableHead>\r\n                                                <TableHead>Descrição</TableHead>\r\n                                                <TableHead className=\"text-right\">Valor</TableHead>\r\n                                            </TableRow>\r\n                                        </TableHeader>\r\n                                        <TableBody>\r\n                                            {group.transactions.map((tx) => (\r\n                                                <TableRow key={tx.id}>\r\n                                                    <TableCell>{new Date(tx.data).toLocaleDateString(\"pt-BR\")}</TableCell>\r\n                                                    <TableCell>{tx.descricao}</TableCell>\r\n                                                    <TableCell className=\"text-right\">{formatCurrency(tx.valor)}</TableCell>\r\n                                                </TableRow>\r\n                                            ))}\r\n                                        </TableBody>\r\n                                    </Table>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ))\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Login.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1749,1752],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1749,1752],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\"\r\nimport { useNavigate } from \"react-router-dom\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\"\r\nimport { AlertCircle, CheckCircle2, Loader2 } from \"lucide-react\"\r\n\r\nexport function Login() {\r\n    const navigate = useNavigate()\r\n    const [isLogin, setIsLogin] = useState(true)\r\n    const [loading, setLoading] = useState(false)\r\n    const [email, setEmail] = useState(\"\")\r\n    const [password, setPassword] = useState(\"\")\r\n    const [error, setError] = useState<string | null>(null)\r\n    const [success, setSuccess] = useState<string | null>(null)\r\n\r\n    const handleAuth = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        setLoading(true)\r\n        setError(null)\r\n        setSuccess(null)\r\n\r\n        try {\r\n            if (isLogin) {\r\n                const { error } = await supabase.auth.signInWithPassword({\r\n                    email,\r\n                    password,\r\n                })\r\n                if (error) throw error\r\n                navigate(\"/\")\r\n            } else {\r\n                const { error } = await supabase.auth.signUp({\r\n                    email,\r\n                    password,\r\n                })\r\n                if (error) throw error\r\n                setSuccess(\"Conta criada com sucesso! Verifique seu email ou faça login.\")\r\n                setIsLogin(true) // Switch to login mode for convenience\r\n            }\r\n        } catch (err: any) {\r\n            setError(err.message || \"Ocorreu um erro. Tente novamente.\")\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative flex min-h-screen items-center justify-center overflow-hidden bg-slate-950\">\r\n            {/* 3D Animated Background */}\r\n            <div className=\"absolute inset-0 z-0\">\r\n                <div className=\"absolute -top-[30%] -left-[10%] h-[70vh] w-[70vh] animate-blob rounded-full bg-purple-500/30 mix-blend-multiply blur-3xl filter transition-all duration-10000 ease-in-out\"></div>\r\n                <div className=\"absolute -top-[30%] -right-[10%] h-[70vh] w-[70vh] animate-blob animation-delay-2000 rounded-full bg-indigo-500/30 mix-blend-multiply blur-3xl filter transition-all duration-10000 ease-in-out\"></div>\r\n                <div className=\"absolute -bottom-[30%] left-[20%] h-[70vh] w-[70vh] animate-blob animation-delay-4000 rounded-full bg-pink-500/30 mix-blend-multiply blur-3xl filter transition-all duration-10000 ease-in-out\"></div>\r\n\r\n                {/* Grid Pattern for depth */}\r\n                <div className=\"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]\"></div>\r\n            </div>\r\n\r\n            <Card className=\"z-10 w-full max-w-md border-slate-800 bg-slate-900/80 text-slate-100 backdrop-blur-xl shadow-2xl transition-all duration-300 hover:shadow-purple-500/10\">\r\n                <CardHeader className=\"space-y-1\">\r\n                    <CardTitle className=\"text-2xl font-bold text-center bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent\">\r\n                        {isLogin ? \"Bem-vindo de volta\" : \"Crie sua conta\"}\r\n                    </CardTitle>\r\n                    <CardDescription className=\"text-center text-slate-400\">\r\n                        {isLogin\r\n                            ? \"Entre com suas credenciais para acessar o painel\"\r\n                            : \"Preencha os dados abaixo para começar\"}\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <form onSubmit={handleAuth} className=\"space-y-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"email\">Email</Label>\r\n                            <Input\r\n                                id=\"email\"\r\n                                type=\"email\"\r\n                                placeholder=\"seu@email.com\"\r\n                                value={email}\r\n                                onChange={(e) => setEmail(e.target.value)}\r\n                                required\r\n                                className=\"bg-slate-950/50 border-slate-800 focus:border-purple-500 focus:ring-purple-500/20\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"password\">Senha</Label>\r\n                            <Input\r\n                                id=\"password\"\r\n                                type=\"password\"\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                required\r\n                                className=\"bg-slate-950/50 border-slate-800 focus:border-purple-500 focus:ring-purple-500/20\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"flex justify-end\">\r\n                            <Button\r\n                                variant=\"link\"\r\n                                className=\"px-0 font-normal text-xs text-slate-400 hover:text-purple-400\"\r\n                                onClick={() => navigate(\"/forgot-password\")}\r\n                                type=\"button\"\r\n                            >\r\n                                Esqueci minha senha\r\n                            </Button>\r\n                        </div>\r\n\r\n                        {error && (\r\n                            <Alert variant=\"destructive\" className=\"bg-red-900/20 border-red-900/50 text-red-200\">\r\n                                <AlertCircle className=\"h-4 w-4\" />\r\n                                <AlertTitle>Erro</AlertTitle>\r\n                                <AlertDescription>{error}</AlertDescription>\r\n                            </Alert>\r\n                        )}\r\n\r\n                        {success && (\r\n                            <Alert className=\"bg-green-900/20 border-green-900/50 text-green-200\">\r\n                                <CheckCircle2 className=\"h-4 w-4\" />\r\n                                <AlertTitle>Sucesso</AlertTitle>\r\n                                <AlertDescription>{success}</AlertDescription>\r\n                            </Alert>\r\n                        )}\r\n\r\n                        <Button\r\n                            type=\"submit\"\r\n                            className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 transition-all duration-300 shadow-lg shadow-purple-500/25\"\r\n                            disabled={loading}\r\n                        >\r\n                            {loading ? (\r\n                                <>\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                                    Processando...\r\n                                </>\r\n                            ) : (\r\n                                isLogin ? \"Entrar\" : \"Criar Conta\"\r\n                            )}\r\n                        </Button>\r\n                    </form>\r\n                </CardContent>\r\n                <CardFooter>\r\n                    <Button\r\n                        variant=\"link\"\r\n                        className=\"w-full text-slate-400 hover:text-purple-400 transition-colors\"\r\n                        onClick={() => setIsLogin(!isLogin)}\r\n                    >\r\n                        {isLogin\r\n                            ? \"Não tem uma conta? Cadastre-se\"\r\n                            : \"Já tem uma conta? Entre\"}\r\n                    </Button>\r\n                </CardFooter>\r\n            </Card>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Recurrences.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Settings.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchProfile'. Either include it or remove the dependency array.","line":73,"column":8,"nodeType":"ArrayExpression","endLine":73,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [fetchProfile, user]","fix":{"range":[2516,2522],"text":"[fetchProfile, user]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4584,4587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4584,4587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5646,5649],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5646,5649],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\"\r\nimport { CheckCircle2, AlertCircle, Loader2 } from \"lucide-react\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\"\r\nimport { useToast } from \"@/hooks/use-toast\"\r\n\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\"\r\n\r\nexport function Settings() {\r\n    const { user, signOut, refreshProfile } = useAuth()\r\n    const { toast } = useToast()\r\n    const [loading, setLoading] = useState(false)\r\n    const [setupLoading, setSetupLoading] = useState(false)\r\n    const [deleteLoading, setDeleteLoading] = useState(false)\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false)\r\n    const [message, setMessage] = useState<{ type: \"success\" | \"error\"; text: string } | null>(null)\r\n\r\n    const handleScheduleDeletion = async () => {\r\n        setDeleteLoading(true)\r\n        try {\r\n            const { error } = await supabase.rpc(\"schedule_account_deletion\")\r\n\r\n            if (error) throw error\r\n\r\n            toast({\r\n                title: \"Conta Agendada para Exclusão\",\r\n                description: \"Sua conta será excluída em 30 dias. Você foi desconectado.\",\r\n                className: \"bg-red-600 text-white border-none\",\r\n            })\r\n\r\n            await signOut()\r\n        } catch (error) {\r\n            console.error(\"Error scheduling deletion:\", error)\r\n            toast({\r\n                title: \"Erro\",\r\n                description: \"Não foi possível agendar a exclusão. Tente novamente.\",\r\n                variant: \"destructive\",\r\n            })\r\n            setDeleteLoading(false)\r\n            setIsDeleteModalOpen(false)\r\n        }\r\n    }\r\n\r\n    // Investment Settings State\r\n    const [investmentPercent, setInvestmentPercent] = useState(\"\")\r\n    const [investmentBase, setInvestmentBase] = useState<\"BRUTO\" | \"SOBRA\">(\"SOBRA\")\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            fetchProfile()\r\n        }\r\n    }, [user])\r\n\r\n    const fetchProfile = async () => {\r\n        if (!user) return\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"profiles\")\r\n                .select(\"investimento_percentual, investimento_base\")\r\n                .eq(\"user_id\", user.id)\r\n                .single()\r\n\r\n            if (error && error.code !== \"PGRST116\") throw error\r\n\r\n            if (data) {\r\n                setInvestmentPercent(data.investimento_percentual?.toString() || \"\")\r\n                setInvestmentBase(data.investimento_base || \"SOBRA\")\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Error fetching profile:\", err)\r\n        }\r\n    }\r\n\r\n    const handleSetupCategories = async () => {\r\n        if (!user) return\r\n\r\n        setSetupLoading(true)\r\n        setMessage(null)\r\n\r\n        try {\r\n            const categories = [\r\n                { nome: \"Alimentação\", tipo: \"despesa\", cor: \"red\", user_id: user.id },\r\n                { nome: \"Moradia\", tipo: \"despesa\", cor: \"orange\", user_id: user.id },\r\n                { nome: \"Lazer\", tipo: \"despesa\", cor: \"yellow\", user_id: user.id },\r\n                { nome: \"Salário\", tipo: \"receita\", cor: \"green\", user_id: user.id },\r\n                { nome: \"Investimento\", tipo: \"despesa\", cor: \"purple\", user_id: user.id },\r\n            ]\r\n\r\n            const { data: existing } = await supabase\r\n                .from(\"categories\")\r\n                .select(\"nome\")\r\n                .eq(\"user_id\", user.id)\r\n\r\n            const existingNames = new Set(existing?.map(c => c.nome))\r\n\r\n            const toInsert = categories.filter(c => !existingNames.has(c.nome))\r\n\r\n            if (toInsert.length === 0) {\r\n                setMessage({ type: \"success\", text: \"Todas as categorias padrão já existem.\" })\r\n                return\r\n            }\r\n\r\n            const { error } = await supabase.from(\"categories\").insert(toInsert)\r\n\r\n            if (error) throw error\r\n\r\n            setMessage({ type: \"success\", text: \"Categorias criadas com sucesso!\" })\r\n        } catch (err: any) {\r\n            console.error(\"Error creating categories:\", err)\r\n            setMessage({ type: \"error\", text: \"Erro ao criar categorias: \" + err.message })\r\n        } finally {\r\n            setSetupLoading(false)\r\n        }\r\n    }\r\n\r\n    const handleSaveSettings = async (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        if (!user) return\r\n\r\n        setLoading(true)\r\n        try {\r\n            const updates = {\r\n                user_id: user.id,\r\n                investimento_percentual: parseFloat(investmentPercent),\r\n                investimento_base: investmentBase,\r\n                updated_at: new Date(),\r\n            }\r\n\r\n            const { error } = await supabase\r\n                .from(\"profiles\")\r\n                .upsert(updates, { onConflict: \"user_id\" })\r\n\r\n            if (error) throw error\r\n\r\n            toast({\r\n                title: \"Sucesso!\",\r\n                description: \"Configurações salvas com sucesso.\",\r\n                className: \"bg-green-500 text-white border-none\",\r\n            })\r\n        } catch (err: any) {\r\n            console.error(\"Error saving settings:\", err)\r\n            toast({\r\n                title: \"Erro\",\r\n                description: \"Erro ao salvar configurações.\",\r\n                variant: \"destructive\",\r\n            })\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <h1 className=\"text-3xl font-bold\">Configurações</h1>\r\n\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Investimentos</CardTitle>\r\n                    <CardDescription>\r\n                        Defina suas metas de investimento.\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <form onSubmit={handleSaveSettings} className=\"space-y-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"percent\">Porcentagem de Investimento (%)</Label>\r\n                            <Input\r\n                                id=\"percent\"\r\n                                type=\"number\"\r\n                                placeholder=\"Ex: 20\"\r\n                                value={investmentPercent}\r\n                                onChange={(e) => setInvestmentPercent(e.target.value)}\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"base\">Base de Cálculo</Label>\r\n                            <Select value={investmentBase} onValueChange={(val: \"BRUTO\" | \"SOBRA\") => setInvestmentBase(val)}>\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Selecione...\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"BRUTO\">Sobre a Receita Bruta</SelectItem>\r\n                                    <SelectItem value=\"SOBRA\">Sobre a Sobra (Receita - Despesa)</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n\r\n                        <Button type=\"submit\" disabled={loading}>\r\n                            {loading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                            Salvar Configurações\r\n                        </Button>\r\n                    </form>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Configuração Inicial</CardTitle>\r\n                    <CardDescription>\r\n                        Ferramentas para configurar sua conta.\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        Clique no botão abaixo para criar as categorias padrão (Alimentação, Moradia, Lazer, Salário, Investimento).\r\n                    </p>\r\n\r\n                    {message && (\r\n                        <Alert variant={message.type === \"success\" ? \"default\" : \"destructive\"} className={message.type === \"success\" ? \"border-green-500 text-green-600\" : \"\"}>\r\n                            {message.type === \"success\" ? <CheckCircle2 className=\"h-4 w-4\" /> : <AlertCircle className=\"h-4 w-4\" />}\r\n                            <AlertTitle>{message.type === \"success\" ? \"Sucesso\" : \"Erro\"}</AlertTitle>\r\n                            <AlertDescription>{message.text}</AlertDescription>\r\n                        </Alert>\r\n                    )}\r\n\r\n                    <Button onClick={handleSetupCategories} disabled={setupLoading} variant=\"outline\">\r\n                        {setupLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                        Criar Categorias Padrão\r\n                    </Button>\r\n                </CardContent>\r\n            </Card>\r\n            <Card className=\"border-destructive/50\">\r\n                <CardHeader>\r\n                    <CardTitle className=\"text-destructive\">Zona de Perigo</CardTitle>\r\n                    <CardDescription>\r\n                        Ações irreversíveis ou críticas para sua conta.\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"flex items-center justify-between rounded-lg border border-destructive/20 bg-destructive/10 p-4\">\r\n                        <div className=\"space-y-1\">\r\n                            <p className=\"font-medium text-destructive\">Excluir Conta</p>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                                Sua conta será suspensa por 30 dias antes da exclusão permanente.\r\n                            </p>\r\n                        </div>\r\n                        <Dialog open={isDeleteModalOpen} onOpenChange={setIsDeleteModalOpen}>\r\n                            <DialogTrigger asChild>\r\n                                <Button variant=\"destructive\">Excluir Conta</Button>\r\n                            </DialogTrigger>\r\n                            <DialogContent>\r\n                                <DialogHeader>\r\n                                    <DialogTitle>Tem certeza absoluta?</DialogTitle>\r\n                                    <DialogDescription>\r\n                                        Essa ação agendará a exclusão da sua conta. Você perderá o acesso imediatamente e seus dados serão apagados permanentemente após 30 dias.\r\n                                        <br /><br />\r\n                                        Você pode cancelar a exclusão fazendo login novamente dentro desse período.\r\n                                    </DialogDescription>\r\n                                </DialogHeader>\r\n                                <DialogFooter>\r\n                                    <Button variant=\"outline\" onClick={() => setIsDeleteModalOpen(false)}>Cancelar</Button>\r\n                                    <Button variant=\"destructive\" onClick={handleScheduleDeletion} disabled={deleteLoading}>\r\n                                        {deleteLoading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\r\n                                        Sim, excluir minha conta\r\n                                    </Button>\r\n                                </DialogFooter>\r\n                            </DialogContent>\r\n                        </Dialog>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle>Teste de Plano (Dev Only)</CardTitle>\r\n                    <CardDescription>\r\n                        Alternar entre planos para testar funcionalidades.\r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"flex gap-4\">\r\n                    <Button\r\n                        onClick={async () => {\r\n                            await supabase.rpc('upgrade_to_pro')\r\n                            await refreshProfile()\r\n                            toast({\r\n                                title: \"Sucesso\",\r\n                                description: \"Plano atualizado para PRO\",\r\n                                className: \"bg-green-500 text-white border-none\",\r\n                            })\r\n                        }}\r\n                        className=\"bg-purple-600 hover:bg-purple-700\"\r\n                    >\r\n                        Virar PRO\r\n                    </Button>\r\n                    <Button\r\n                        onClick={async () => {\r\n                            await supabase.rpc('downgrade_to_free')\r\n                            await refreshProfile()\r\n                            toast({\r\n                                title: \"Sucesso\",\r\n                                description: \"Plano atualizado para FREE\",\r\n                            })\r\n                        }}\r\n                        variant=\"outline\"\r\n                    >\r\n                        Virar FREE\r\n                    </Button>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    )\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\Transactions.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2942,2945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2942,2945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2976,2979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2976,2979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3654,3657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3654,3657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState, useCallback } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { useAuth } from \"@/contexts/AuthContext\"\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Trash2, Pencil } from \"lucide-react\"\r\nimport { NewTransactionModal } from \"@/components/NewTransactionModal\"\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\n\r\nimport { Transaction } from \"@/types\"\r\nimport { MonthSelector } from \"@/components/MonthSelector\"\r\n\r\nimport { useProject } from \"@/contexts/ProjectContext\"\r\n\r\nexport function Transactions() {\r\n    const { user } = useAuth()\r\n    const { selectedProject } = useProject()\r\n    const [transactions, setTransactions] = useState<Transaction[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [error, setError] = useState<string | null>(null)\r\n    const [currentDate, setCurrentDate] = useState(new Date())\r\n\r\n    // Edit state\r\n    const [editingTransaction, setEditingTransaction] = useState<Transaction | null>(null)\r\n    const [isModalOpen, setIsModalOpen] = useState(false)\r\n\r\n    const fetchTransactions = useCallback(async () => {\r\n        if (!user) return\r\n\r\n        try {\r\n            setLoading(true)\r\n            const startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).toISOString()\r\n            const endOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).toISOString()\r\n\r\n            let query = supabase\r\n                .from(\"transactions\")\r\n                .select(\"*, categories(nome, cor)\")\r\n                .eq(\"user_id\", user.id)\r\n                .gte(\"data\", startOfMonth)\r\n                .lte(\"data\", endOfMonth)\r\n                .order(\"data\", { ascending: false })\r\n\r\n            if (selectedProject) {\r\n                query = query.eq(\"project_id\", selectedProject.id)\r\n            } else {\r\n                query = query.is(\"project_id\", null)\r\n            }\r\n\r\n            const { data, error } = await query\r\n\r\n            if (error) throw error\r\n\r\n            // Supabase returns nested data, we need to cast or ensure type safety.\r\n            // The interface above expects 'categories' as an object or null.\r\n            // If the join returns an array (one-to-many), we might need to handle it, \r\n            // but here it's many-to-one (transaction -> category), so it should be a single object if using .single() or just object if relation is correct.\r\n            // Actually, Supabase JS client returns an object for single relation if configured, or array.\r\n            // Let's verify at runtime or assume object based on typical setup. \r\n            // Usually it returns an object if it's a foreign key relation.\r\n\r\n            setTransactions(data as any || [])\r\n        } catch (err: any) {\r\n            console.error(\"Error fetching transactions:\", err)\r\n            setError(\"Erro ao carregar transações.\")\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }, [user, currentDate, selectedProject])\r\n\r\n    useEffect(() => {\r\n        fetchTransactions()\r\n    }, [fetchTransactions])\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (!confirm(\"Tem certeza que deseja excluir esta transação?\")) return\r\n\r\n        try {\r\n            const { error } = await supabase.from(\"transactions\").delete().eq(\"id\", id)\r\n            if (error) throw error\r\n\r\n            // Refresh list\r\n            fetchTransactions()\r\n        } catch (err: any) {\r\n            console.error(\"Error deleting transaction:\", err)\r\n            alert(\"Erro ao excluir transação.\")\r\n        }\r\n    }\r\n\r\n    const handleEdit = (transaction: Transaction) => {\r\n        setEditingTransaction(transaction)\r\n        setIsModalOpen(true)\r\n    }\r\n\r\n    const handleModalClose = (open: boolean) => {\r\n        setIsModalOpen(open)\r\n        if (!open) setEditingTransaction(null)\r\n    }\r\n\r\n    const handleSuccess = () => {\r\n        fetchTransactions()\r\n        setIsModalOpen(false)\r\n        setEditingTransaction(null)\r\n    }\r\n\r\n    const formatCurrency = (value: number) => {\r\n        return new Intl.NumberFormat(\"pt-BR\", {\r\n            style: \"currency\",\r\n            currency: \"BRL\",\r\n        }).format(value)\r\n    }\r\n\r\n    const formatDate = (dateString: string) => {\r\n        return new Date(dateString).toLocaleDateString(\"pt-BR\")\r\n    }\r\n\r\n    const getCategoryColor = (color: string) => {\r\n        switch (color) {\r\n            case \"red\": return \"bg-red-500 hover:bg-red-600\"\r\n            case \"orange\": return \"bg-orange-500 hover:bg-orange-600\"\r\n            case \"yellow\": return \"bg-yellow-500 hover:bg-yellow-600\"\r\n            case \"green\": return \"bg-green-500 hover:bg-green-600\"\r\n            case \"blue\": return \"bg-blue-500 hover:bg-blue-600\"\r\n            case \"purple\": return \"bg-purple-500 hover:bg-purple-600\"\r\n            default: return \"bg-gray-500 hover:bg-gray-600\"\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <h1 className=\"text-3xl font-bold\">Transações</h1>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <MonthSelector currentDate={currentDate} onMonthChange={setCurrentDate} />\r\n                    <NewTransactionModal\r\n                        open={isModalOpen}\r\n                        onOpenChange={handleModalClose}\r\n                        onSuccess={handleSuccess}\r\n                        transactionToEdit={editingTransaction}\r\n                    />\r\n                    <Button onClick={() => setIsModalOpen(true)} className=\"gap-2\">\r\n                        Nova Transação\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {error && (\r\n                <Alert variant=\"destructive\">\r\n                    <AlertTitle>Erro</AlertTitle>\r\n                    <AlertDescription>{error}</AlertDescription>\r\n                </Alert>\r\n            )}\r\n\r\n            <div className=\"rounded-md border\">\r\n                <Table>\r\n                    <TableHeader>\r\n                        <TableRow>\r\n                            <TableHead>Descrição</TableHead>\r\n                            <TableHead>Categoria</TableHead>\r\n                            <TableHead>Data</TableHead>\r\n                            <TableHead className=\"text-right\">Valor</TableHead>\r\n                            <TableHead className=\"w-[100px] text-right\">Ações</TableHead>\r\n                        </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                        {loading ? (\r\n                            <TableRow>\r\n                                <TableCell colSpan={5} className=\"text-center h-24\">\r\n                                    Carregando...\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        ) : transactions.length === 0 ? (\r\n                            <TableRow>\r\n                                <TableCell colSpan={5} className=\"text-center h-24 text-muted-foreground\">\r\n                                    Nenhuma transação encontrada.\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        ) : (\r\n                            transactions.map((transaction) => (\r\n                                <TableRow key={transaction.id}>\r\n                                    <TableCell className=\"font-medium\">{transaction.descricao}</TableCell>\r\n                                    <TableCell>\r\n                                        {transaction.categories ? (\r\n                                            <Badge className={`${getCategoryColor(transaction.categories.cor)} text-white border-0`}>\r\n                                                {transaction.categories.nome}\r\n                                            </Badge>\r\n                                        ) : (\r\n                                            <span className=\"text-muted-foreground\">-</span>\r\n                                        )}\r\n                                    </TableCell>\r\n                                    <TableCell>{formatDate(transaction.data)}</TableCell>\r\n                                    <TableCell\r\n                                        className={`text-right font-bold ${transaction.tipo === \"receita\" ? \"text-green-600\" : \"text-red-600\"\r\n                                            }`}\r\n                                    >\r\n                                        {formatCurrency(transaction.valor)}\r\n                                    </TableCell>\r\n                                    <TableCell className=\"text-right\">\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-8 w-8 text-muted-foreground hover:text-primary mr-1\"\r\n                                            onClick={() => handleEdit(transaction)}\r\n                                        >\r\n                                            <Pencil className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-8 w-8 text-muted-foreground hover:text-destructive\"\r\n                                            onClick={() => handleDelete(transaction.id)}\r\n                                        >\r\n                                            <Trash2 className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            ))\r\n                        )}\r\n                    </TableBody>\r\n                </Table>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\auth\\ForgotPassword.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\pages\\auth\\UpdatePassword.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\types\\dashboard.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Documentos\\Arquivos - Luis\\Projetos\\teste_gemini\\finance-control\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]